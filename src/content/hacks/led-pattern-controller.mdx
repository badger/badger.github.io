---
title: "LED Pattern Controller"
description: "Create mesmerizing LED patterns with your Badger 2350. Control brightness, colors, and timing."
difficulty: "easy"
duration: 15
tags: ["LED", "Patterns", "Beginner"]
thumbnail: "/images/hacks/led-pattern.jpg"
author: "HackShelf Team"
date: "2025-01-15"
hardware:
  - "Badger 2350"
  - "5mm RGB LEDs (x3)"
  - "220Œ© resistors (x3)"
  - "Jumper wires"
  - "Breadboard"
github: "https://github.com/badger/hackshelf-samples/tree/main/led-pattern-controller"
---

# LED Pattern Controller

Transform your Badger 2350 into a mesmerizing light show controller! This beginner-friendly project will teach you how to control multiple LEDs and create stunning visual patterns.

<div class="highlight-box">
  <p><strong>üéØ What you'll learn:</strong> GPIO control, PWM signals, pattern generation, and user interface design</p>
  <p><strong>‚è±Ô∏è Time needed:</strong> 15 minutes</p>
  <p><strong>üîß Difficulty:</strong> Easy - Perfect for beginners</p>
</div>

## What You'll Build

In this hack, you'll create a system that can:

- ‚ú® Control multiple RGB LEDs independently
- üåà Generate various light patterns (fade, pulse, rainbow)
- üéÆ Use the badge buttons to switch between patterns
- üì± Display pattern information on the e-ink screen

> **Fun Fact:** This project uses PWM (Pulse Width Modulation) to control LED brightness - the same technique used in professional lighting systems!

## Step 1: Set Up Your Development Environment

First, let's prepare your Badger 2350 for the project. Make sure you have the latest MicroPython firmware installed.

```python
# Test your setup with this simple LED blink
import badger2350 as badger
from machine import Pin
import time

# Initialize the badge
badger.init()

# Test LED on pin 2
led = Pin(2, Pin.OUT)

# Blink test
for i in range(5):
    led.on()
    time.sleep(0.5)
    led.off()
    time.sleep(0.5)

print("Setup complete! ‚úÖ")
```

<div class="callout tip">
  <h4>üí° Pro Tip</h4>
  <p>Always test your basic setup before moving to complex patterns. This simple blink test confirms your wiring and code environment are working correctly.</p>
</div>

## Step 2: Initialize the Hardware

Now let's set up the PWM (Pulse Width Modulation) system to control our LEDs with variable brightness and color.

```python
import badger2350 as badger
from machine import Pin, PWM
import time
import math

# Initialize the badge
badger.init()
display = badger.Display()

# Set up LED pins with PWM for smooth brightness control
led_red = PWM(Pin(2))    # Red channel
led_green = PWM(Pin(3))  # Green channel  
led_blue = PWM(Pin(4))   # Blue channel

# Set PWM frequency (1000 Hz works perfectly for LEDs)
for led in [led_red, led_green, led_blue]:
    led.freq(1000)

print("LED Pattern Controller initialized! üåà")

# Quick RGB test
def test_colors():
    colors = [
        (65535, 0, 0),     # Red
        (0, 65535, 0),     # Green
        (0, 0, 65535),     # Blue
        (65535, 65535, 0), # Yellow
        (65535, 0, 65535), # Magenta
        (0, 65535, 65535), # Cyan
    ]
    
    for r, g, b in colors:
        led_red.duty_u16(r)
        led_green.duty_u16(g) 
        led_blue.duty_u16(b)
        time.sleep(0.5)
    
    # Turn off
    for led in [led_red, led_green, led_blue]:
        led.duty_u16(0)

# Run the test
test_colors()
```

<div class="callout warning">
  <h4>‚ö†Ô∏è Safety First</h4>
  <p>Always double-check your wiring before powering on. Incorrect connections can damage your LEDs or the Badger 2350. Use a multimeter to verify connections if you're unsure.</p>
</div>

## Step 3: Create Stunning Patterns

Time for the fun part! Let's create various lighting patterns that will make your setup truly impressive.

### Pattern 1: Smooth Breathing Effect

```python
def pattern_breathe():
    """Creates a smooth breathing/pulsing effect"""
    print("ü´Å Breathing pattern active")
    
    for cycle in range(3):  # 3 complete breath cycles
        # Inhale - fade in
        for brightness in range(0, 65536, 800):
            intensity = int(math.sin(brightness / 65535 * math.pi) * 65535)
            
            led_red.duty_u16(intensity)
            led_green.duty_u16(intensity // 3)     # Dimmer green
            led_blue.duty_u16(intensity // 2)      # Medium blue
            time.sleep_ms(30)
        
        # Exhale - fade out  
        for brightness in range(65535, -1, -800):
            intensity = int(math.sin(brightness / 65535 * math.pi) * 65535)
            
            led_red.duty_u16(intensity)
            led_green.duty_u16(intensity // 3)
            led_blue.duty_u16(intensity // 2)
            time.sleep_ms(30)
        
        time.sleep_ms(500)  # Pause between breaths
```

### Pattern 2: Rainbow Cycle

```python
def hsv_to_rgb(h, s, v):
    """Convert HSV color to RGB values"""
    h = h % 360
    c = v * s
    x = c * (1 - abs((h / 60) % 2 - 1))
    m = v - c
    
    if h < 60:
        r, g, b = c, x, 0
    elif h < 120:
        r, g, b = x, c, 0
    elif h < 180:
        r, g, b = 0, c, x
    elif h < 240:
        r, g, b = 0, x, c
    elif h < 300:
        r, g, b = x, 0, c
    else:
        r, g, b = c, 0, x
    
    return int((r + m) * 65535), int((g + m) * 65535), int((b + m) * 65535)

def pattern_rainbow():
    """Beautiful rainbow color cycling"""
    print("üåà Rainbow pattern active")
    
    for cycle in range(2):  # 2 complete rainbow cycles
        for hue in range(0, 360, 3):  # Step through all hues
            r, g, b = hsv_to_rgb(hue, 1.0, 1.0)
            
            led_red.duty_u16(r)
            led_green.duty_u16(g)
            led_blue.duty_u16(b)
            
### Pattern 3: Sparkle Effect

```python
import random

def pattern_sparkle():
    """Random sparkle effects"""
    print("‚ú® Sparkle pattern active")
    
    # Base dim lighting
    base_brightness = 5000
    
    for _ in range(100):  # 100 sparkle events
        # Set base lighting
        led_red.duty_u16(base_brightness)
        led_green.duty_u16(base_brightness)
        led_blue.duty_u16(base_brightness)
        
        # Random sparkle
        led_choice = random.choice([led_red, led_green, led_blue])
        sparkle_brightness = random.randint(30000, 65535)
        
        # Quick flash
        led_choice.duty_u16(sparkle_brightness)
        time.sleep_ms(random.randint(50, 200))
        led_choice.duty_u16(base_brightness)
        time.sleep_ms(random.randint(100, 500))
```

## Step 4: Add Interactive Controls

Let's make your pattern controller interactive using the Badger 2350's built-in buttons.

```python
# Pattern management system
patterns = [
    ("Breathe", pattern_breathe),
    ("Rainbow", pattern_rainbow), 
    ("Sparkle", pattern_sparkle)
]

current_pattern = 0
running = True

def update_display():
    """Update the e-ink display with current pattern info"""
    display.clear()
    display.text(f"Pattern: {patterns[current_pattern][0]}", 10, 20, scale=2)
    display.text(f"Press A/B to change", 10, 60, scale=1)
    display.text(f"Press C to stop", 10, 80, scale=1)
    display.update()

def main_loop():
    """Main program loop with button handling"""
    global current_pattern, running
    
    update_display()
    
    while running:
        # Check button presses
        if badger.pressed_to_wake(badger.BUTTON_A):
            current_pattern = (current_pattern + 1) % len(patterns)
            update_display()
            time.sleep(0.3)  # Debounce
            
        elif badger.pressed_to_wake(badger.BUTTON_B):
            current_pattern = (current_pattern - 1) % len(patterns)
            update_display()
            time.sleep(0.3)  # Debounce
            
        elif badger.pressed_to_wake(badger.BUTTON_C):
            running = False
            # Turn off all LEDs
            for led in [led_red, led_green, led_blue]:
                led.duty_u16(0)
            display.clear()
            display.text("Pattern stopped", 10, 40, scale=2)
            display.update()
            break
        
        # Run current pattern
        patterns[current_pattern][1]()
        time.sleep_ms(100)

# Start the controller
if __name__ == "__main__":
    print("üöÄ LED Pattern Controller Starting...")
    main_loop()
    print("üëã Thanks for using LED Pattern Controller!")
```

<div class="callout info">
  <h4>üéÆ Control Guide</h4>
  <ul>
    <li><strong>Button A:</strong> Next pattern</li>
    <li><strong>Button B:</strong> Previous pattern</li>
    <li><strong>Button C:</strong> Stop and exit</li>
  </ul>
</div>

## Step 5: Testing Your Build

Let's make sure everything works perfectly:

### Checklist

1. **‚úÖ Power Test**
   - Connect your Badger 2350 via USB
   - Upload the complete code
   - Watch for the startup message

2. **‚úÖ LED Test**
   - All three LEDs should light up during the color test
   - Colors should be vibrant and clearly distinguishable
   - No flickering or dim lighting

3. **‚úÖ Pattern Test**
   - Try each pattern using Button A
   - Patterns should transition smoothly
   - Display should update with pattern names

4. **‚úÖ Control Test**
   - Test forward/backward navigation (A/B buttons)
   - Confirm stop functionality (C button)
   - Check display updates

<div class="callout tip">
  <h4>üîß Troubleshooting</h4>
  <p><strong>LEDs not lighting up?</strong> Check your resistor values and wiring polarity.</p>
  <p><strong>Dim or flickering LEDs?</strong> Ensure your power supply can handle the current draw.</p>
  <p><strong>Patterns not changing?</strong> Add debug print statements to verify button presses.</p>
</div>

## What's Next?

Congratulations! You've built a fully functional LED pattern controller. Here are some exciting ideas to expand your project:

### üöÄ Enhancement Ideas

- **Sound Reactive Patterns**: Add a microphone sensor to create music-synchronized lighting
- **WiFi Integration**: Control patterns remotely via a web interface
- **Motion Sensing**: Use an accelerometer to change patterns based on movement  
- **Color Customization**: Add a web interface for custom color selection
- **Multi-Zone Control**: Expand to control multiple LED strips independently

### üìö Learning Opportunities

- **Advanced PWM**: Learn about different PWM frequencies and their effects
- **Color Theory**: Dive deeper into HSV color spaces and color mixing
- **Real-time Systems**: Explore interrupt-driven pattern changes
- **Power Management**: Implement sleep modes and battery optimization

---

*Ready to light up your next project? Share your creation with the HackShelf community and inspire others to build amazing things with their Badger 2350!*
```

:::tip
**Tip:** You can use any color LEDs, but RGB LEDs give you more creative options for patterns!
:::

## Circuit Diagram

Connect your components as shown in the diagram below:

```
Badger 2350    ‚Üí    LED 1 (Red)    ‚Üí    220Œ© Resistor    ‚Üí    GND
GPIO 2         ‚Üí    LED 2 (Green)  ‚Üí    220Œ© Resistor    ‚Üí    GND
GPIO 3         ‚Üí    LED 3 (Blue)   ‚Üí    220Œ© Resistor    ‚Üí    GND
```

## Step-by-Step Tutorial

### Step 1: Set Up Your Development Environment

First, make sure you have the Badger 2350 firmware and development tools installed:

```python
# Install required libraries
import badger2350
import time
import math
```

### Step 2: Initialize the Hardware

Create the basic setup code to initialize your LEDs and display:

```python
import badger2350 as badger
from machine import Pin, PWM
import time
import math

# Initialize the display
badger.init()
display = badger.Display()

# Set up LED pins with PWM for brightness control
led_red = PWM(Pin(2))
led_green = PWM(Pin(3))  
led_blue = PWM(Pin(4))

# Set PWM frequency (1000 Hz works well for LEDs)
led_red.freq(1000)
led_green.freq(1000)
led_blue.freq(1000)

print("LED Pattern Controller initialized!")
```

:::warning
**Important:** Always check your wiring before powering on. Incorrect connections can damage your components.
:::

### Step 3: Create Pattern Functions

Now let's create different lighting patterns:

```python
def pattern_fade():
    """Smooth fade in/out pattern"""
    for brightness in range(0, 65536, 1000):
        led_red.duty_u16(brightness)
        led_green.duty_u16(brightness // 2)
        led_blue.duty_u16(brightness // 3)
        time.sleep_ms(50)
    
    for brightness in range(65535, -1, -1000):
        led_red.duty_u16(brightness)
        led_green.duty_u16(brightness // 2)
        led_blue.duty_u16(brightness // 3)
        time.sleep_ms(50)

def pattern_rainbow():
    """RGB rainbow cycle"""
    for hue in range(360):
        # Convert HSV to RGB
        rgb = hsv_to_rgb(hue, 1.0, 1.0)
        
        led_red.duty_u16(int(rgb[0] * 65535))
        led_green.duty_u16(int(rgb[1] * 65535))
        led_blue.duty_u16(int(rgb[2] * 65535))
        
        time.sleep_ms(20)

def pattern_pulse():
    """Pulsing pattern with different colors"""
    colors = [
        (65535, 0, 0),      # Red
        (0, 65535, 0),      # Green
        (0, 0, 65535),      # Blue
        (65535, 32768, 0),  # Orange
    ]
    
    for color in colors:
        for i in range(20):
            brightness = int((math.sin(i * 0.3) + 1) * 32767)
            led_red.duty_u16(int(color[0] * brightness / 65535))
            led_green.duty_u16(int(color[1] * brightness / 65535))
            led_blue.duty_u16(int(color[2] * brightness / 65535))
            time.sleep_ms(100)
```

### Step 4: Add Button Controls

Let's add button controls to switch between patterns:

```python
# Button setup
button_a = Pin(badger.BUTTON_A, Pin.IN, Pin.PULL_UP)
button_b = Pin(badger.BUTTON_B, Pin.IN, Pin.PULL_UP)
button_c = Pin(badger.BUTTON_C, Pin.IN, Pin.PULL_UP)

current_pattern = 0
patterns = [
    ("Fade", pattern_fade),
    ("Rainbow", pattern_rainbow),
    ("Pulse", pattern_pulse)
]

def update_display():
    """Update the e-ink display with current pattern info"""
    display.clear()
    display.text(f"LED Pattern Controller", 10, 10, scale=2)
    display.text(f"Current: {patterns[current_pattern][0]}", 10, 40, scale=1)
    display.text(f"Press A/B to change", 10, 60, scale=1)
    display.text(f"Press C to stop", 10, 80, scale=1)
    display.update()

def check_buttons():
    """Check for button presses"""
    global current_pattern
    
    if not button_a.value():  # Button A pressed
        current_pattern = (current_pattern + 1) % len(patterns)
        update_display()
        time.sleep_ms(200)  # Debounce
        
    if not button_b.value():  # Button B pressed
        current_pattern = (current_pattern - 1) % len(patterns)
        update_display()
        time.sleep_ms(200)  # Debounce
```

### Step 5: Main Program Loop

Finally, let's put it all together in the main loop:

```python
def hsv_to_rgb(h, s, v):
    """Convert HSV color to RGB"""
    h = h / 360.0
    i = int(h * 6)
    f = (h * 6) - i
    p = v * (1 - s)
    q = v * (1 - s * f)
    t = v * (1 - s * (1 - f))
    
    if i % 6 == 0:
        return (v, t, p)
    elif i % 6 == 1:
        return (q, v, p)
    elif i % 6 == 2:
        return (p, v, t)
    elif i % 6 == 3:
        return (p, q, v)
    elif i % 6 == 4:
        return (t, p, v)
    else:
        return (v, p, q)

# Main program
def main():
    update_display()
    running = True
    
    while running:
        check_buttons()
        
        # Check for stop button
        if not Pin(badger.BUTTON_C, Pin.IN, Pin.PULL_UP).value():
            running = False
            break
            
        # Run current pattern
        patterns[current_pattern][1]()
    
    # Clean up - turn off all LEDs
    led_red.duty_u16(0)
    led_green.duty_u16(0)
    led_blue.duty_u16(0)
    
    print("LED Pattern Controller stopped")

# Start the program
if __name__ == "__main__":
    main()
```

## Testing Your Build

1. **Upload the code** to your Badger 2350
2. **Check your wiring** - LEDs should light up when the program starts
3. **Test the buttons**:
   - Press A to cycle forward through patterns
   - Press B to cycle backward through patterns
   - Press C to stop the program
4. **Watch the display** - It should show the current pattern name

## Troubleshooting

**LEDs not lighting up?**
- Check your wiring connections
- Verify resistor values (220Œ©)
- Make sure GPIO pins are correctly assigned

**Pattern not changing?**
- Check button connections
- Verify button debouncing delay

**Display not updating?**
- Ensure display initialization is correct
- Check for any error messages in the console

## Next Steps

Congratulations! You've built your first LED pattern controller. Here are some ideas to expand your project:

- Add more LED patterns (strobe, sparkle, breathing)
- Control pattern speed with potentiometer
- Add sound reactive patterns using a microphone
- Create custom patterns that respond to WiFi data
- Build a web interface to control patterns remotely

## Resources

- [Badger 2350 GPIO Reference](https://example.com/gpio-reference)
- [PWM Control Documentation](https://example.com/pwm-docs)
- [Color Theory for LEDs](https://example.com/color-theory)

---

**Difficulty:** Easy | **Time Required:** 15 minutes | **Components:** 5

*Happy hacking! Share your creations with #BadgerHack*