---
title: "LED Pattern Controller"
description: "Create mesmerizing LED patterns with your Badger 2350. Control brightness, colors, and timing."
difficulty: "easy"
duration: 15
tags: ["LED", "Patterns", "Beginner"]
thumbnail: "/images/hacks/led-pattern.jpg"
author: "HackShelf Team"
date: "2025-01-15"
hardware:
  - "Badger 2350"
  - "5mm RGB LEDs (x3)"
  - "220Ω resistors (x3)"
  - "Jumper wires"
  - "Breadboard"
github: "https://github.com/badger/hackshelf-samples/tree/main/led-pattern-controller"
---

# LED Pattern Controller

Transform your Badger 2350 into a mesmerizing light show controller! This beginner-friendly project will teach you how to control multiple LEDs and create stunning visual patterns.

## What You'll Build

In this hack, you'll create a system that can:
- Control multiple RGB LEDs independently
- Generate various light patterns (fade, pulse, rainbow)
- Use the badge buttons to switch between patterns
- Display pattern information on the e-ink screen

## Hardware Requirements

Before we start, make sure you have these components:

- **Badger 2350** - Your main controller
- **RGB LEDs (x3)** - 5mm common cathode RGB LEDs work best
- **220Ω Resistors (x3)** - For current limiting
- **Jumper Wires** - To make connections
- **Breadboard** - For prototyping

:::tip
**Tip:** You can use any color LEDs, but RGB LEDs give you more creative options for patterns!
:::

## Circuit Diagram

Connect your components as shown in the diagram below:

```
Badger 2350    →    LED 1 (Red)    →    220Ω Resistor    →    GND
GPIO 2         →    LED 2 (Green)  →    220Ω Resistor    →    GND
GPIO 3         →    LED 3 (Blue)   →    220Ω Resistor    →    GND
```

## Step-by-Step Tutorial

### Step 1: Set Up Your Development Environment

First, make sure you have the Badger 2350 firmware and development tools installed:

```python
# Install required libraries
import badger2350
import time
import math
```

### Step 2: Initialize the Hardware

Create the basic setup code to initialize your LEDs and display:

```python
import badger2350 as badger
from machine import Pin, PWM
import time
import math

# Initialize the display
badger.init()
display = badger.Display()

# Set up LED pins with PWM for brightness control
led_red = PWM(Pin(2))
led_green = PWM(Pin(3))  
led_blue = PWM(Pin(4))

# Set PWM frequency (1000 Hz works well for LEDs)
led_red.freq(1000)
led_green.freq(1000)
led_blue.freq(1000)

print("LED Pattern Controller initialized!")
```

:::warning
**Important:** Always check your wiring before powering on. Incorrect connections can damage your components.
:::

### Step 3: Create Pattern Functions

Now let's create different lighting patterns:

```python
def pattern_fade():
    """Smooth fade in/out pattern"""
    for brightness in range(0, 65536, 1000):
        led_red.duty_u16(brightness)
        led_green.duty_u16(brightness // 2)
        led_blue.duty_u16(brightness // 3)
        time.sleep_ms(50)
    
    for brightness in range(65535, -1, -1000):
        led_red.duty_u16(brightness)
        led_green.duty_u16(brightness // 2)
        led_blue.duty_u16(brightness // 3)
        time.sleep_ms(50)

def pattern_rainbow():
    """RGB rainbow cycle"""
    for hue in range(360):
        # Convert HSV to RGB
        rgb = hsv_to_rgb(hue, 1.0, 1.0)
        
        led_red.duty_u16(int(rgb[0] * 65535))
        led_green.duty_u16(int(rgb[1] * 65535))
        led_blue.duty_u16(int(rgb[2] * 65535))
        
        time.sleep_ms(20)

def pattern_pulse():
    """Pulsing pattern with different colors"""
    colors = [
        (65535, 0, 0),      # Red
        (0, 65535, 0),      # Green
        (0, 0, 65535),      # Blue
        (65535, 32768, 0),  # Orange
    ]
    
    for color in colors:
        for i in range(20):
            brightness = int((math.sin(i * 0.3) + 1) * 32767)
            led_red.duty_u16(int(color[0] * brightness / 65535))
            led_green.duty_u16(int(color[1] * brightness / 65535))
            led_blue.duty_u16(int(color[2] * brightness / 65535))
            time.sleep_ms(100)
```

### Step 4: Add Button Controls

Let's add button controls to switch between patterns:

```python
# Button setup
button_a = Pin(badger.BUTTON_A, Pin.IN, Pin.PULL_UP)
button_b = Pin(badger.BUTTON_B, Pin.IN, Pin.PULL_UP)
button_c = Pin(badger.BUTTON_C, Pin.IN, Pin.PULL_UP)

current_pattern = 0
patterns = [
    ("Fade", pattern_fade),
    ("Rainbow", pattern_rainbow),
    ("Pulse", pattern_pulse)
]

def update_display():
    """Update the e-ink display with current pattern info"""
    display.clear()
    display.text(f"LED Pattern Controller", 10, 10, scale=2)
    display.text(f"Current: {patterns[current_pattern][0]}", 10, 40, scale=1)
    display.text(f"Press A/B to change", 10, 60, scale=1)
    display.text(f"Press C to stop", 10, 80, scale=1)
    display.update()

def check_buttons():
    """Check for button presses"""
    global current_pattern
    
    if not button_a.value():  # Button A pressed
        current_pattern = (current_pattern + 1) % len(patterns)
        update_display()
        time.sleep_ms(200)  # Debounce
        
    if not button_b.value():  # Button B pressed
        current_pattern = (current_pattern - 1) % len(patterns)
        update_display()
        time.sleep_ms(200)  # Debounce
```

### Step 5: Main Program Loop

Finally, let's put it all together in the main loop:

```python
def hsv_to_rgb(h, s, v):
    """Convert HSV color to RGB"""
    h = h / 360.0
    i = int(h * 6)
    f = (h * 6) - i
    p = v * (1 - s)
    q = v * (1 - s * f)
    t = v * (1 - s * (1 - f))
    
    if i % 6 == 0:
        return (v, t, p)
    elif i % 6 == 1:
        return (q, v, p)
    elif i % 6 == 2:
        return (p, v, t)
    elif i % 6 == 3:
        return (p, q, v)
    elif i % 6 == 4:
        return (t, p, v)
    else:
        return (v, p, q)

# Main program
def main():
    update_display()
    running = True
    
    while running:
        check_buttons()
        
        # Check for stop button
        if not Pin(badger.BUTTON_C, Pin.IN, Pin.PULL_UP).value():
            running = False
            break
            
        # Run current pattern
        patterns[current_pattern][1]()
    
    # Clean up - turn off all LEDs
    led_red.duty_u16(0)
    led_green.duty_u16(0)
    led_blue.duty_u16(0)
    
    print("LED Pattern Controller stopped")

# Start the program
if __name__ == "__main__":
    main()
```

## Testing Your Build

1. **Upload the code** to your Badger 2350
2. **Check your wiring** - LEDs should light up when the program starts
3. **Test the buttons**:
   - Press A to cycle forward through patterns
   - Press B to cycle backward through patterns
   - Press C to stop the program
4. **Watch the display** - It should show the current pattern name

## Troubleshooting

**LEDs not lighting up?**
- Check your wiring connections
- Verify resistor values (220Ω)
- Make sure GPIO pins are correctly assigned

**Pattern not changing?**
- Check button connections
- Verify button debouncing delay

**Display not updating?**
- Ensure display initialization is correct
- Check for any error messages in the console

## Next Steps

Congratulations! You've built your first LED pattern controller. Here are some ideas to expand your project:

- Add more LED patterns (strobe, sparkle, breathing)
- Control pattern speed with potentiometer
- Add sound reactive patterns using a microphone
- Create custom patterns that respond to WiFi data
- Build a web interface to control patterns remotely

## Resources

- [Badger 2350 GPIO Reference](https://example.com/gpio-reference)
- [PWM Control Documentation](https://example.com/pwm-docs)
- [Color Theory for LEDs](https://example.com/color-theory)

---

**Difficulty:** Easy | **Time Required:** 15 minutes | **Components:** 5

*Happy hacking! Share your creations with #BadgerHack*